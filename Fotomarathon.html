<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FOTOMARATHON</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f9; margin:0; padding:0; }
    .logo { width: 100%; display: block; }
    .container { max-width: 500px; margin: auto; background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-top: 10px; }
    h2 { text-align: center; margin: 5px 0; }
    .instructions { background: #eef; padding: 10px; border-radius: 8px; margin-bottom: 20px; font-size: 14px; }
    .rules-title { text-align: center; font-weight: bold; font-size: 18px; margin-bottom: 10px; }
    ul { list-style: none; padding: 0; }
    li { margin: 10px 0; display: flex; align-items: center; }
    input[type="checkbox"] { transform: scale(1.5); margin-right: 12px; }
    label { font-size: 16px; }
    #timerDisplay, #pauseTimerDisplay { font-size: 24px; font-weight: bold; margin: 5px; text-align:center; }
    #checklistProgress { margin-top: 10px; font-size: 16px; }
    button { padding: 8px 16px; font-size: 16px; margin: 5px; border: none; border-radius: 6px; color: white; cursor: pointer; }
    #startTimerBtn { background-color: #4CAF50; }
    #pauseBtn { background-color: #888; }
    #resetTimerBtn { background-color: #f44336; }
    #releaseLocksBtn { background-color: #2196F3; }
    button:disabled { opacity: 0.6; cursor: not-allowed; }
    #pauseTimerDisplay { color: red; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body>
  <img src="NORDLO.png" alt="Logo" class="logo">
  <div class="container">
    <h2>FOTOMARATHON</h2>
    <h2>Lloret de Mar</h2>

    <div class="instructions">
      <div class="rules-title">REGLER</div>
      <p>- Alla i laget ska synas p√• alla bilderna.</p>
      <p>- En person m√•ste alltid utf√∂ra samma sak p√• alla bilder. Gapa/str√§cka upp h√§nderna/st√• √•t fel h√•ll eller n√•t annat fyndigt.</p>
      <p>- Laget m√•ste vara tillbaka exakt 75 minuter efter att startsignalen g√•r.</p>
      <p>(Fotobevis kr√§vs: Gruppbild framf√∂r scenen med klockslag synligt.)</p>
    </div>

    <div style="text-align:center; margin-bottom: 20px;">
      <div id="timerDisplay">75:00</div>
      <div id="pauseTimerDisplay"></div>
      <div id="checklistProgress">0% klara</div>
      <button id="startTimerBtn">Starta timer</button>
      <button id="pauseBtn" disabled>Pausa 10 min</button>
      <button id="resetTimerBtn">Nollst√§ll timer</button>
      <button id="releaseLocksBtn">Sl√§pp alla sp√§rrar</button>
    </div>

    <ul id="checklist" style="display:none;"></ul>
  </div>

  <script>
    const items = [
      'En gruppbild p√• det minsta utrymmet ni f√•r plats i',
      'Bygg n√•got tillsammans (Fri tolkning. G√∂r en m√§nsklig pyramid, bygg ett sandslott eller hitta en byggarbetsplats.)',
      'En ov√§ntad v√§nskap...!',
      'Alla i laget g√∂r samma sak (tex Alla i luften, alla p√• huk, walk like an egyptian...)',
      'En ‚Äúolycka‚Äù p√• semestern',
      'Havstema',
      'F√∂re & efter ‚Äì ta tv√• bilder bredvid varandra: en ‚Äúseri√∂s aff√§rsbild‚Äù och en ‚Äúsemesterbild‚Äù p√• samma plats.',
      'Skriv NORDLO i sanden p√• stranden och ta en gruppbild',
      'Kl√§m ihop n√•t j√§ttestort',
      'Det minsta och st√∂rsta ni hittar, som ryms i en hand',
      'G√∂r honn√∂r framf√∂r en font√§n!',
      'Krama en palm!',
      'G√∂r tummen upp framf√∂r Iglesia de San Rom√°n',
      'Turistf√§llan ‚Äì posera framf√∂r n√•got helt vardagligt (t.ex. en soptunna) som om det vore stadens st√∂rsta sev√§rdhet',
      'Alla √§r v√§nda bort fr√•n kameran',
      'Ta en gruppbild med en katt/hund/valfritt djur',
      'Peta p√• en motorcykel. En ska se glad ut, alla andra f√∂rskr√§ckta',
      'Ramla! (roliga gatan fram)',
      'Ha en livlig argumentation',
      'Spela fotboll',
      '√Ñt n√•t litet, men gapa s√• att det √§r n√•t j√§ttestort',
      '√Öterskapa skivomslaget till Beatles - Abbey road'
    ];

    const checklist = document.getElementById('checklist');
    items.forEach((item,index)=>{
      const li = document.createElement('li');
      const checkbox = document.createElement('input');
      checkbox.type='checkbox';
      checkbox.id=`task${index+1}`;
      if(localStorage.getItem(checkbox.id)==='true') checkbox.checked=true;
      checkbox.addEventListener('change',()=>{
        localStorage.setItem(checkbox.id,checkbox.checked);
        updateChecklistProgress();
        if(checkbox.checked && /Mobi|Android/i.test(navigator.userAgent)){
          confetti({particleCount:100, spread:70, origin:{y:0.6}});
        }
      });
      const label = document.createElement('label');
      label.htmlFor=checkbox.id;
      label.innerText=item;
      li.appendChild(checkbox);
      li.appendChild(label);
      checklist.appendChild(li);
    });

    const checklistProgress = document.getElementById('checklistProgress');
    function updateChecklistProgress(){
      const checkboxes = checklist.querySelectorAll('input[type="checkbox"]');
      const total = checkboxes.length;
      const checked = Array.from(checkboxes).filter(cb=>cb.checked).length;
      checklistProgress.innerText = `${Math.round((checked/total)*100)}% klara`;
    }
    updateChecklistProgress();

    const timerDisplay = document.getElementById('timerDisplay');
    const pauseTimerDisplay = document.getElementById('pauseTimerDisplay');
    const startBtn = document.getElementById('startTimerBtn');
    const resetBtn = document.getElementById('resetTimerBtn');
    const pauseBtn = document.getElementById('pauseBtn');
    const releaseBtn = document.getElementById('releaseLocksBtn');

    let totalDuration = 75*60*1000; // 75 minuter
    let pauseDuration = 10*60*1000; // 10 minuter
    let timer, pauseTimer;
    let timerStarted = false;
    let pausedOnce = localStorage.getItem('pausedOnce')==='true';
    let mainRemaining = totalDuration;

    function formatTime(seconds){ 
      const m=Math.floor(seconds/60), s=seconds%60; 
      return `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`; 
    }

    function startMainTimer(){
      if(timerStarted) return;
      timerStarted = true;
      startBtn.disabled = true;
      startBtn.style.backgroundColor = "#888";
      pauseBtn.disabled = false;
      pauseBtn.style.backgroundColor = "#4CAF50";

      checklist.style.display = "block";

      if(!localStorage.getItem('timerStart')) localStorage.setItem('timerStart',Date.now());

      clearInterval(timer);
      timer=setInterval(()=>{
        const elapsed = Date.now()-localStorage.getItem('timerStart');
        mainRemaining = Math.ceil((totalDuration-elapsed)/1000);
        if(mainRemaining<=0) {
          mainRemaining=0;
          clearInterval(timer);
          localStorage.removeItem('pausedOnce');
          localStorage.removeItem('timerStart');
          localStorage.removeItem('pauseStart');
          pauseBtn.disabled=false;
          pauseBtn.style.backgroundColor="#4CAF50";

          if("vibrate" in navigator){
            navigator.vibrate(10000);
          }
          alert("T√§vlingen √§r √∂ver!");
        }

        if(mainRemaining === 300){
          if("vibrate" in navigator){
            navigator.vibrate(10000);
          }
          alert("5 minuter kvar av t√§vlingen!");
        }

        timerDisplay.innerText=formatTime(mainRemaining);
      },1000);
    }

    function startPause(){
      if(!timerStarted) return;
      if(pausedOnce) return;
      if(!confirm("OBS! Denna g√•r att anv√§nda endast en g√•ng!\n√Ñr du s√§ker p√• att du vill pausa?")) return;

      pausedOnce=true;
      localStorage.setItem('pausedOnce','true');

      clearInterval(timer);
      localStorage.setItem('pauseStart',Date.now());
      pauseBtn.disabled=true;
      pauseBtn.style.backgroundColor="#888";

      checklist.style.display = "none"; // üëà g√∂m checklistan under paus

      let pauseRemaining = pauseDuration/1000;
      pauseTimerDisplay.innerText = "Paus " + formatTime(pauseRemaining);

      pauseTimer = setInterval(()=>{
        pauseRemaining--;
        if(pauseRemaining<=0){
          clearInterval(pauseTimer);
          pauseTimerDisplay.innerText='';
          checklist.style.display = "block"; // üëà visa checklistan igen efter paus
          startMainTimer();
        } else {
          pauseTimerDisplay.innerText = "Paus " + formatTime(pauseRemaining);
        }
      },1000);
    }

    resetBtn.addEventListener('click', () => {
      alert("APP-APP-APP!\nF√∂rs√∂k inte fuska!\n\nEtt meddelande har skickats till ledningen att ni tryckt p√• denna knapp!");
    });

    startBtn.addEventListener('click', startMainTimer);
    pauseBtn.addEventListener('click', startPause);

    releaseBtn.addEventListener('click',()=>{
      if(confirm("Vill ni verkligen sl√§ppa alla sp√§rrar?")){
        const checkboxes = checklist.querySelectorAll('input[type=\"checkbox\"]');
        checkboxes.forEach(cb=>{
          cb.checked=false;
          localStorage.setItem(cb.id,false);
        });
        updateChecklistProgress();
      }
    });

  </script>
</body>
</html>
