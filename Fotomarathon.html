<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FOTOMARATHON</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f9;
      margin: 0;
      padding: 0;
    }
    .logo {
      width: 100%;
      display: block;
    }
    .container {
      max-width: 500px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-top: 10px;
    }
    h2 {
      text-align: center;
      margin: 5px 0;
    }
    .instructions {
      background: #eef;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-size: 14px;
    }
    .rules-title {
      text-align: center;
      font-weight: bold;
      font-size: 18px;
      margin-bottom: 10px;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      margin: 10px 0;
      display: flex;
      align-items: center;
    }
    input[type="checkbox"] {
      transform: scale(1.5);
      margin-right: 12px;
    }
    label {
      font-size: 16px;
    }
    #timerDisplay {
      font-size: 24px;
      font-weight: bold;
    }
    #checklistProgress {
      margin-top: 10px;
      font-size: 16px;
    }
    button {
      padding: 8px 16px;
      font-size: 16px;
      margin: 5px;
      border: none;
      border-radius: 6px;
      background-color: #4CAF50;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background-color: #45a049;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body>
  <img src="NORDLO.png" alt="Logo" class="logo">
  <div class="container">
    <h2>FOTOMARATHON</h2>
    <h2>Lloret de Mar</h2>

    <div class="instructions">
      <div class="rules-title">REGLER</div>
      <p>- Alla i laget ska synas på alla bilderna.</p>
      <p>- En person måste alltid utföra samma sak på alla bilder. Gapa/sträcka upp händerna/stå åt fel håll eller nåt annat fyndigt.</p>
      <p>- Laget måste vara tillbaka exakt 75 minuter efter att startsignalen går.</p>
      <p>(Fotobevis krävs: Gruppbild framför scenen med klockslag synligt.)</p>
    </div>

    <div style="text-align:center; margin-bottom: 20px;">
      <div id="timerDisplay">75:00</div>
      <div id="checklistProgress">0% klara</div>
      <button id="startTimerBtn">Starta timer</button>
      <button id="resetTimerBtn">Nollställ timer</button>
      <button id="pauseTimerBtn">Pausa</button>
    </div>

    <ul id="checklist"></ul>
  </div>

  <script>
    const items = [
      'Den minsta platsen där de alla får plats för en gruppbild',
      'Vi bygger något tillsammans (fri tolkning. Gör en pyramid eller bygg ett sandslott eller hitta en byggarbetsplats.)',
      'Oväntad vänskap',
      'Alla i laget gör samma sak samtidigt (tex Alla i luften eller liknande)',
      'En “olycka” på semestern',
      'Havstema',
      'Före & efter – ta två bilder bredvid varandra: en “seriös affärsbild” och en “semesterbild” på samma plats.',
      'Skriv NORDLO i sanden på stranden och ta en gruppbild',
      'Kläm ihop nåt jättestort',
      'Det minsta och största de hittar, som ryms i en hand',
      'Gör honnör framför en fontän',
      'Krama en palm',
      'Gör tummen upp framför Iglesia de San Román',
      'Turistfällan – posera framför något helt vardagligt (t.ex. en soptunna) som om det vore stadens största sevärdhet',
      'Alla är vända bort från kameran',
      'Ta kort på en katt/hund',
      'En jokerbild som de själva hittar på – men de måste kunna förklara hur den visar samarbete.',
      'Peta på en motorcykel. En ska se glad ut, alla andra ska vara förskräckta',
      'Ramla',
      'Stå på tå i en dörröppning',
      'Ha en livlig argumentation',
      'Spela fotboll',
      'Ät nåt litet, men gapa så att det är nåt jättestort',
      'Återskapa skivomslaget till Beatles - Abbey road'
    ];

    const checklist = document.getElementById('checklist');
    const checklistProgress = document.getElementById('checklistProgress');
    const timerDisplay = document.getElementById('timerDisplay');
    const startBtn = document.getElementById('startTimerBtn');
    const resetBtn = document.getElementById('resetTimerBtn');
    const pauseBtn = document.getElementById('pauseTimerBtn');

    let totalDuration = 75 * 60 * 1000;
    let pauseDuration = 10 * 60 * 1000;
    let timer;
    let pauseTimer;
    let pauseUsed = localStorage.getItem('pauseUsed') === 'true';

    // Skapa checklistan
    items.forEach((item, index) => {
      const li = document.createElement('li');
      const checkbox = document.createElement('input');
      const label = document.createElement('label');

      checkbox.type = 'checkbox';
      checkbox.id = `task${index+1}`;

      if (localStorage.getItem(checkbox.id) === 'true') {
        checkbox.checked = true;
      }

      checkbox.addEventListener('change', () => {
        localStorage.setItem(checkbox.id, checkbox.checked);
        updateChecklistProgress();

        if (checkbox.checked && /Mobi|Android/i.test(navigator.userAgent)) {
          confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
        }
      });

      label.htmlFor = checkbox.id;
      label.innerText = item;

      li.appendChild(checkbox);
      li.appendChild(label);
      checklist.appendChild(li);
    });

    function updateChecklistProgress() {
      const checkboxes = checklist.querySelectorAll('input[type="checkbox"]');
      const total = checkboxes.length;
      const checked = Array.from(checkboxes).filter(cb => cb.checked).length;
      const percent = Math.round((checked / total) * 100);
      checklistProgress.innerText = `${percent}% klara`;
    }
    updateChecklistProgress();

    function updateTimer(secondsLeft, prefix = "") {
      const minutes = Math.floor(secondsLeft / 60);
      const seconds = secondsLeft % 60;
      timerDisplay.innerText = `${prefix}${minutes.toString().padStart(2,'0')}:${seconds.toString().padStart(2,'0')}`;
    }

    function startTimer() {
      if (!localStorage.getItem('timerStart')) {
        localStorage.setItem('timerStart', Date.now());
      }
      clearInterval(timer);
      timer = setInterval(() => {
        const startTime = parseInt(localStorage.getItem('timerStart'));
        const elapsed = Date.now() - startTime;
        let remaining = Math.ceil((totalDuration - elapsed) / 1000);
        if (remaining <= 0) {
          remaining = 0;
          clearInterval(timer);
        }
        updateTimer(remaining);
      }, 1000);
    }

    function startPause() {
      if (pauseUsed) return;
      if (!confirm("OBS! Denna går att använda endast en gång!\nÄr du säker på att du vill pausa?")) return;
      pauseUsed = true;
      localStorage.setItem('pauseUsed', 'true');
      clearInterval(timer);

      // Dölj alla kryssrutor under pausen
      checklist.style.display = 'none';

      const pauseEnd = Date.now() + pauseDuration;
      pauseTimer = setInterval(() => {
        let remaining = Math.ceil((pauseEnd - Date.now()) / 1000);
        if (remaining <= 0) {
          clearInterval(pauseTimer);
          checklist.style.display = 'block';
          startTimer();
        }
        updateTimer(remaining, "Paus ");
      }, 1000);

      pauseBtn.disabled = true;
    }

    function showCheatAlert() {
      alert("APP-APP-APP!\nFörsök inte fuska!\n\nLedningen har nu fått ett mail om att ni tryckt på knappen!");
    }

    startBtn.addEventListener('click', startTimer);
    pauseBtn.addEventListener('click', startPause);
    resetBtn.addEventListener('click', showCheatAlert);

    if (localStorage.getItem('timerStart')) {
      startTimer();
    } else {
      updateTimer(totalDuration / 1000);
    }

    // Förhindra reload under paus
    window.addEventListener('beforeunload', (e) => {
      if (pauseUsed && pauseTimer) {
        e.preventDefault();
        e.returnValue = '';
      }
    });
  </script>
</body>
</html>
